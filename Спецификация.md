# 6. Спецификация программного обеспечения

## Архитектура
- Платформа: **Android**
- Фреймворк: **Android SDK**
- Язык программирования: **Java**

## Общая структура системы
Приложение разделено на логические модули. Связь между слоями осуществляется через ViewModel и Repository.

### Слои:
- **View (UI):** 
- **ViewModel:** 
- **Repository:** 
- **Model:** 

---

## Модули системы

### 6.1 Модуль аутентификации
**Назначение:** регистрация, вход и выход пользователей.

**Классы:**
- AuthRepository
- AuthViewModel
- LoginActivity
- RegisterActivity

**Интерфейсы:**
- Firebase Authentication API

**Функции:**
- Регистрация пользователя
- Аутентификация
- Выход из системы
- Проверка текущей сессии

---

### 6.2 Модуль пользователя
**Назначение:** управление профилем пользователя и расчет норм.

**Классы:**
- UserRepository
- UserViewModel
- ProfileFragment

**Данные:**
- Антропометрия (вес, рост, возраст, пол)
- Цели (похудение, поддержание, набор массы)
- Уровень активности

**Расчёты:**
- BMR
- TDEE
- Целевые калории
- Нормы БЖУ

---

### 6.3 Модуль питания
**Назначение:** управление рационом и блюдами.

**Классы:**
- MealRepository
- MealViewModel
- DietFragment

**Интеграция:**
- Spoonacular API

**Функции:**
- Генерация дневного рациона
- Сохранение блюд в Firestore
- Отображение приёмов пищи
- Отметка съеденных блюд

---

### 6.4 Модуль тренера
**Назначение:** управление клиентами и их рационом.

**Классы:**
- CoachViewModel
- ClientsFragment
- CoachRequestsAdapter

**Функции:**
- Просмотр клиентов
- Просмотр рациона клиентов
- Комментирование блюд
- Управление заявками

---

### 6.5 Модуль заявок
**Назначение:** управление связью тренер-клиент.

**Классы:**
- CoachRequestRepository
- CoachRequestViewModel

**Состояния заявки:**
- PENDING — ожидает ответа
- ACCEPTED — принята
- REJECTED — отклонена
- CANCELLED — отменена

---

## Алгоритмы

### Алгоритм расчета норм КБЖУ

```java
// BMR (Основной Уровень Метаболизма)
if (gender == "male") {
    bmr = 10*weight + 6.25*height - 5*age + 5;
} else {
    bmr = 10*weight + 6.25*height - 5*age - 161;
}

// TDEE (Общий Ежедневный Расход Энергии)
tdee = bmr * activityMultiplier;

// Целевые калории
switch(goal) {
    case "LOSE": calories = tdee * 0.8;
    case "MAINTAIN": calories = tdee;
    case "GAIN": calories = tdee * 1.15;
}
```
## Алгоритм обработки заявок тренер-клиент

1. Проверка существования активной заявки  
2. Создание записи в Firestore  
3. Уведомление тренера  
4. Получение ответа (ACCEPTED / REJECTED)  
5. Обновление связи пользователь–тренер  
6. Обновление статуса заявки  

---

## Ограничения

- Требуется интернет-соединение для генерации рациона  
- Ограничение Spoonacular API: **150 запросов/день**  
- Firestore: **1GB бесплатного хранения**  
- Минимальная версия Android: **8.0 (API 26)**  
